# Override para desarrollo con Docker (Windows + WSL).
# Levanta: docker compose up -d
# Backend y Celery usan DROPTOOLS_ENV=development → Reporter vía Celery pero con config de desarrollo (timeouts, logs).
# En la UI verás "Modo desarrollo (Docker)". Sirve para probar el flujo igual que en producción antes de subir al servidor.
# Para testeo del reporter con 6 workers: celery_worker usa --concurrency=6 (y más recursos).
services:
  backend:
    environment:
      - DROPTOOLS_ENV=development
    volumes:
      - ./backend:/app/backend
      - ./raw_data:/app/raw_data
      - ./scripts:/app/scripts
  celery_worker:
    environment:
      - DROPTOOLS_ENV=development
    # 6 workers para testeo del reporter por slot (work stealing entre 3 usuarios)
    command: celery -A droptools_backend worker -l info --concurrency=6
    deploy:
      resources:
        limits:
          cpus: '6.0'
          memory: 8G
        reservations:
          cpus: '2.0'
          memory: 4G
